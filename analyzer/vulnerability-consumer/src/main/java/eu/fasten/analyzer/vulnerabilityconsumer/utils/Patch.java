package eu.fasten.analyzer.vulnerabilityconsumer.utils;

import com.fasterxml.jackson.annotation.*;

import java.io.*;
import java.util.*;

public class Patch implements Serializable {
    @JsonProperty(value = "filename")
    private String fileName;
    @JsonProperty(value = "patch_date")
    private String patchDate;
    @JsonProperty(value = "patch_url")
    private String patchUrl;
    @JsonProperty(value = "original_changed_line_numbers")
    private List<Integer> originalChangedLineNumbers;
    @JsonProperty(value = "new_changed_line_numbers")
    private List<Integer> newChangedLineNumbers;

    /**
     * Empty Constructor for Serialization.
     */
    public Patch() {
        this.originalChangedLineNumbers = new ArrayList<>();
        this.newChangedLineNumbers      = new ArrayList<>();
    }

    /**
     * Patch class constructor.
     * @param fileName - file that was changed.
     * @param originalChangedLineNumbers - changed lines in the original file.
     * @param newChangedLineNumbers - changed lines in the new file.
     * @param patchUrl - url where the patch was retrieved.
     * @param patchDate - date of the patch.
     */
    public Patch(String fileName,
                 List<Integer> originalChangedLineNumbers,
                 List<Integer> newChangedLineNumbers,
                 String patchUrl,
                 String patchDate) {
        this.originalChangedLineNumbers = originalChangedLineNumbers;
        this.newChangedLineNumbers      = newChangedLineNumbers;
        this.fileName  = fileName;
        this.patchUrl  = patchUrl;
        this.patchDate = patchDate;
    }

    public String getFileName() {
        return fileName;
    }

    public void setFileName(String fileName) {
        this.fileName = fileName;
    }

    public String getPatchDate() {
        return patchDate;
    }

    public void setPatchDate(String patchDate) {
        this.patchDate = patchDate;
    }

    public String getPatchUrl() {
        return patchUrl;
    }

    public void setPatchUrl(String patchUrl) {
        this.patchUrl = patchUrl;
    }

    public List<Integer> getOriginalChangedLineNumbers() {
        return originalChangedLineNumbers;
    }

    public void setOriginalChangedLineNumbers(List<Integer> originalChangedLineNumbers) {
        this.originalChangedLineNumbers = originalChangedLineNumbers;
    }

    public List<Integer> getNewChangedLineNumbers() {
        return newChangedLineNumbers;
    }

    public void setNewChangedLineNumbers(List<Integer> newChangedLineNumbers) {
        this.newChangedLineNumbers = newChangedLineNumbers;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        Patch patch = (Patch) o;
        return Objects.equals(fileName, patch.fileName) &&
                Objects.equals(originalChangedLineNumbers, patch.originalChangedLineNumbers) &&
                Objects.equals(newChangedLineNumbers, patch.newChangedLineNumbers);
    }

    @Override
    public int hashCode() {
        return Objects.hash(fileName, originalChangedLineNumbers, newChangedLineNumbers);
    }

    @Override
    public String toString() {
        return "Patch{" +
                "fileName='" + fileName + '\'' +
                ", patchDate='" + patchDate + '\'' +
                ", patchUrl='" + patchUrl + '\'' +
                ", originalChangedLineNumbers=" + originalChangedLineNumbers +
                ", newChangedLineNumbers=" + newChangedLineNumbers +
                '}';
    }
}